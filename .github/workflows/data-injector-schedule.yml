name: Geomonitor Data Injector

on:
  schedule:
    # Runs every 5 minutes (at minutes 0, 5, 10, etc.)
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  inject_data_to_firebase:
    runs-on: ubuntu-latest
    
    steps:
      # 1️⃣ Checkout the repository code
      - uses: actions/checkout@v4

      # 2️⃣ Set up Python environment
      - uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # 3️⃣ Install required Python dependencies
      - name: Install Dependencies
        run: pip install requests geopy python-dotenv

      # 4️⃣ Run the data injection script
      - name: Run Data Injector Script
        env:
          FIREBASE_URL: ${{ secrets.FIREBASE_URL }}
          NEWS_API_KEY: ${{ secrets.NEWS_API_KEY }}
          GEOAPIFY_KEY: ${{ secrets.GEOAPIFY_KEY }}
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: python data_injector.py
